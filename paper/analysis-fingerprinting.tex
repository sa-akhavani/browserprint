\subsubsection{Analyzing fingerprinting API presence in Chrome, Firefox, and Opera}

Recall that one of the key research questions we asked at the beginning of
this paper was if popular browsers such as Firefox, Chrome, and Opera are
generally becoming more fingerprintable over time. In particular, we
were also interested in answering if every browser version is unique
in a fingerprintability sense.

Using the fingerprinting APIs that we collected (and described in
Section \ref{sec:methodology}), we aimed to determine how many of
these APIs are available and active in specific browser versions. That
is, we iterated through all the major Firefox and Chrome browser
versions between 2016 and 2020, and tested their fingerprintability.

In Chrome 49 (i.e., the oldest Chrome version in our analysis),
there exist 139 APIs from the suspicious fingerprinting APIs list. Which
means they could be used for fingerprinting. In Chrome
81 (the newest Chrome version in our analysis), there
exist 274 APIs from the suspicious fingerprinting APIs list. In short, the
number of APIs that could be used for fingerprinting Chrome versions
are increasing over time. That is, the data suggest that Chrome is
becoming easier to fingerprint as it evolves over time.

Compared to Chrome, Firefox 45 (i.e., the oldest version in our study)
has 147 APIs from the suspicious fingerprinting APIs list. In contrast,
Firefox 75 (which is the latest Firefox version in our study) has 271
fingerprinting APIs from the suspicious fingerprinting APIs list.
Interestingly, though, Firefox 71 has 276 APIs from the suspicious
fingerprinting APIs list. Our data analysis suggests that
Firefox has become more fingerprintable over time, but that lately,
although more features are added to it, its fingerprintability might
have started to decline. In fact, Firefox has indeed started to take
the fingerprinting problem seriously and has been increasingly taking
steps to prevent it (e.g.,~\cite{FirefoxFingerprinting}).

In addition, Opera 36 (i.e., the oldest version in our study) contains 139
suspicious fingerprinting APIs. On the other hand, Opera 68 (the latest Opera version in our measurement)
is consist of 274 suspicious fingerprinting APIs. The trend is very similar to Google Chrome but there are minor
differences at some points which could be seen in Figure~\ref{fig:fingerprint-apis}.

Figure \ref{fig:fingerprint-apis} depicts, in detail, the presence of
fingerprinting APIs in Chrome, Firefox, and Opera that we measured. Note that
in January 2017, there is a significant increase in the number of
fingerprinting APIs that each browser supports. More than 100
fingerprinting APIs were added to both browsers. To determine what
caused this spike, we investigated and analyzed the release notes of
both Firefox 51~\cite{firefox-51-notes}, Chrome
56~\cite{chrome-56-notes}, and Opera 43 which is based on Chromium 56~\cite{opera-43-notes}.

The release notes indicate that HTML5 was enabled for all users by
default in Chrome 56. As of this version, Adobe Flash Player was
disabled and only allowed to run with specific user permissions.
Chrome also enabled the WebGL 2.0 API that provides a new rendering
context, and supports objects for the HTML5 Canvas elements. This
context allows rendering using an API that conforms closely to the
OpenGL ES 3.0
API\footnote{\url{https://www.khronos.org/registry/webgl/specs/latest/2.0/}}.
Similarly, in Firefox 51, we observed that the browser had also added
WebGL2 support during that time. The same happened to Opera 43 since Chromium 56
added WebGL2 support to its codebase.

When we analyzed our fingerprinting API list, we saw that the 107 new
fingerprinting APIs that became possible as of this date were actually
related to \texttt{WebGL2RenderingContext} which was added to Firefox
51, Chrome 56, and Opera 43. The straight-forward lesson to distill from our
observation is that browser vendors need to be extra careful when they
implement and release new features if they are interested in making
their browsers more difficult to fingerprint.

% We decided to analyze some minor spikes in Figure \ref{fig:fingerprint-apis}
% besides January 2017 which had the greatest spike in the graph.
% In September 2017, \texttt{NetworkInformation} API was added to Chrome 61
% that provided information about the connection a device is using to communicate with the network~\cite{network-information}.
% Also, in April 2017, \texttt{BaseAudioContext} API was added to Firefox 53.
% \texttt{BaseAudioContext} acts as a base definition for online and offline audio-processing graphs~\cite{base-audio-context}.
% Both of these APIs exist in our suspicious fingerprinting APIs list and potentially could be used to fingerprint a user.
% Surprisingly, these APIs were not even mentioned directly in Chrome 61~\cite{chrome-61-notes} and Firefox 53~\cite{firefox-53-notes} release notes.
% Hence, even a minor feature addition to a browser, which might not have been discussed in the release notes, could
% include fingerprintable APIs that increase the possibility of browser fingerprintability.

\begin{figure}[ht]
    \centering
    \includegraphics[width=\columnwidth]{figures/Fingerprinting-APIs.png}
    \caption{Presence of Fingerprinting APIs in Chrome, Firefox, and Opera.}
    \label{fig:fingerprint-apis}
\end{figure}

As part of our experiments, we also collected the feature sets for Firefox's Private Window,
Google Chrome's Incognito, and Opera's Private Window. We measured the
fingerprintability of the browsers in these modes. For Chrome, our results show
that there is a small difference between the total number of features in regular
mode versus the total number of features in incognito mode. For instance,
Chrome 80's regular mode has 11,946 features while it has 11,936 features
available in Incognito mode. The results were similar for Firefox's regular mode
versus its Private Window Mode. For example, Firefox 75's regular mode has 6,370
total features while its Private Window Mode has 6,358 features available. Besides,
Opera's private window had the same fingerprinting APIs compared to the regular mode
and had zero impact on reducing fingerprintability.

Hence, we conclude that the incognito and private window modes do not help
users against browser fingerprinting since every fingerprinting API that exists
in a version's normal mode also appears in the same browser version's Incognito
(or Private Window) mode.

\subsubsection{Unique Feature Set}

In our analyses, we automatically deduced a ``feature set'' for each
browser version that we analyzed. A feature set is a set of (i.e., the
list of) browser features that exist in that specific browser version
under analysis. When we compared the features sets for each browser
version to each other (e.g., Firefox 54 versus 55), we observed that
each feature set was unique for all the browser versions that we
tested. That is, there exist no two browsers that possess the same
feature set. Hence, from this observation, we can deduce that all the
browser versions that we analyzed are uniquely fingerprintable.

The reason why the feature sets are unique among different browser
versions is that each browser, as we described before, have recurring
as well as non-persistent features. As a result, the fact that vendors
continuously add, remove, and sometimes re-add features into their
browsers also make them more fingerprintable.

%One key difference between Google Chrome when compared to Mozilla
%Firefox is that Chrome is adding many more new features to the newer
%versions of the browser while at the same time keeping older features
%around. Firefox, in comparison, seems to be more aggressive with
%respect to removing older features from the browser, and hence,
%``debloating'' the software.

One interesting trend is that the differences between the feature sets
of Chrome, Firefox, and Opera in their newer versions is becoming smaller.
That is, we observed much more intersections with each other than in
older versions. Our data suggest that the feature sets for all
Firefox, Chrome, and Opera are converging towards homogeneity of browser
features.
