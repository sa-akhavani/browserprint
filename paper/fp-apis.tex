\subsection{Browser Fingerprinting APIs}
\label{sec:fp-apis}

We conduct an in-depth analysis in order to determine which browser features are associated with fingerprinting. Our analysis generates a list of suspicious APIs that we use in our measurements in Section~\ref{sec:analysis} to quantify \textit{fingerprintability}: the ratio of browser features in a browser version that are associated with fingerprinting techniques. We describe in the following how we determine which browser features are related to browser fingerprinting.

Our list of suspicious browser fingerprinting APIs contains a total of 313 JavaScript APIs. These APIs are considered suspicious because the purpose of using these API depends on the intent of the programmer who writes the code. 
We call this list \textit{suspicious fingerprinting APIs} in this paper.
In Panopticlick's research~\cite{panopticlick}, browser fingerprinting is achieved through a combination of APIs that seem innocent, such as \texttt{Navigator.plugins}, \texttt{Navigator.userAgent}, and \texttt{Screen.colorDepth}. These APIs provide functionality that matches their original objectives. However, they can be abused by creating a unique fingerprint of the client's browser due to exposing information that narrows down the diversity of visited users. %Based on our approach taken to collect APIs, there is no way to determine whether the source code is doing browser fingerprinting without the acknowledgment of the writer of the code. 

We use two methods to assemble the list of fingerprinting APIs: literature review and experimental analysis. Literature review, the foundation of the API list, is composed of four core fingerprinting papers, Panopticlick~\cite{panopticlick}, AmIUnique~\cite{amiunique}, Hiding in the Crowd~\cite{hidinginthecrowd}, and FPDetective~\cite{fpdetective}. This analysis resulted in approximately 10\% of the list of suspicious fingerprinting APIs. Some of the APIs are directly mentioned in these papers and the others are modified to match standard APIs\footnote{\url{https://developer.mozilla.org/en-US/docs/Web/API}} with the same functionality. The concepts of Canvas, WebGL, Font fingerprinting are introduced among these APIs. These concepts lead to the next turn of investigation of papers which are Cookieless Monster~\cite{cookiemonster-SP13} and Pixel Perfect~\cite{mowery2012pixel}. This investigation does not bring more APIs but a direction to experimental analysis. 

The experimental analysis consists of two stages, collecting APIs by crawling websites and extracting suspicious APIs from the crawling data. In terms of data collecting, the workflow is the same as the one in VisibleV8~\cite{vv8-imc19}. A customized crawler was driven to visit all websites in the Easylist~\cite{Easylist} domain file that contains 13,241 domains. Then, the raw logs generated by VisibleV8 were gathered and the VisibleV8 post processor was applied to process the raw data. After removing duplicate and non-standard APIs, the APIs usage of 8,682 domains with 56,828 origins was collected. Non-standard APIs indicate ones that are not listed in the WebIDL~\cite{webidl} data package. In other words, VisibleV8 and its post processor were adopted to aggregate and summarize standard JS API usage of the target domains.

While collecting APIs from the wild, the API suspicious list was extended through crawling on \url{panopticlick.eff.org}, \url{amiunique.org}, and \url{browserleaks.com} websites. These websites are explicitly marked as browser fingerprinting websites. Therefore, augmenting suspicious fingerprinting APIs among these websites is more efficient than a random walk on the enormous JS API pool.

The next step is to perform a manual analysis to check every API utilized by these three websites. First, we search for information and usage of an API on Mozilla's MDN Web Docs~\cite{mdnwebdocs}. Then, we determine whether an API fingerprints users based on the information the API conveys. That is to say, an API is classified as a suspicious fingerprinting API if it can provide the information to filter certain users out. For example, there are two users with distinct user agents. By calling Navigator.userAgent, the programmer should be able to distinguish between these two users. Navigator.userAgent can be recognized as a fingerprinting API in this case. The majority of suspicious fingerprinting APIs comes from the manual analysis and the idea of categorizing fingerprinting APIs is incited by the \url{browserleaks.com} website. 

The last step is to manually search for more fingerprinting APIs with the keyword. Namely, in Canvas fingerprinting, most APIs include the ``Canvas'' or ``CanvasRendering''. A program was created to filtrate APIs that contain ``Canvas'' or ``CanvasRendering'' among APIs of 8k crawled domains. The same pattern also applies to BatteryManager, WebGLRenderingContext, and SpeechSynthesis. Meanwhile, the fingerprint2.js~\cite{fingerprintjs2020Oct} was reviewed to supplement the suspicious fingerprinting API list.  

There are limitations to the methods we used for constructing a suspicious fingerprinting API list. First and foremost, this list only provides a partial view of full fingerprinting APIs. To the best of our knowledge, there is no complete table of fingerprinting APIs and more research is needed in this direction. The second limitation is during the manual analysis. There could be misconceptions between the API usage provided by Mozilla web APIs page and the way programmers exploit them. Lastly, part of JS APIs is filtered out by the VisibleV8 post processor. This can be improved by using a larger set of WebIDL data or precisely use the aggregated raw APIs. 

We plan to make our list of fingerprinting APIs publicly available upon publication.